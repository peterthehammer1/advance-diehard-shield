<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Advance SPAM/RoboCall Filter Dashboard</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <header>
    <h1>SPAM/RoboCall Filter Dashboard</h1>
    <span class="subtitle">Phase 2A — Advance Stores</span>
  </header>

  <nav class="tabs">
    <button class="tab active" data-tab="dashboard">Dashboard</button>
    <button class="tab" data-tab="phone-lists">Phone Lists</button>
    <button class="tab" data-tab="call-log">Call Log</button>
    <button class="tab" data-tab="simulation">Simulation</button>
    <button class="tab" data-tab="nucleus-voice">Nucleus Voice</button>
  </nav>

  <!-- Dashboard Tab -->
  <section id="tab-dashboard" class="tab-content active">
    <div class="metrics-row">
      <div class="metric-card">
        <div class="metric-value" id="metric-total">—</div>
        <div class="metric-label">Total Calls</div>
      </div>
      <div class="metric-card metric-blocked">
        <div class="metric-value" id="metric-blocked">—</div>
        <div class="metric-label">Blocked</div>
      </div>
      <div class="metric-card metric-allowed">
        <div class="metric-value" id="metric-allowed">—</div>
        <div class="metric-label">Allowed</div>
      </div>
      <div class="metric-card metric-flagged">
        <div class="metric-value" id="metric-false-positives">—</div>
        <div class="metric-label">False Positives</div>
      </div>
    </div>

    <div class="breakdown-section">
      <h3>Classification Breakdown</h3>
      <div id="classification-bars"></div>
    </div>

    <div class="feed-section">
      <h3>Live Call Feed</h3>
      <div id="live-feed" class="live-feed"></div>
    </div>
  </section>

  <!-- Phone Lists Tab -->
  <section id="tab-phone-lists" class="tab-content">
    <div class="lists-container">
      <div class="list-column">
        <h3 class="list-header whitelist-header">Whitelist (Always Allow)</h3>
        <form id="whitelist-form" class="add-form">
          <input type="tel" name="phone_number" placeholder="+1-555-0100" required>
          <input type="text" name="label" placeholder="Name / label">
          <button type="submit">Add</button>
        </form>
        <div id="whitelist-entries" class="list-entries"></div>
      </div>
      <div class="list-column">
        <h3 class="list-header blacklist-header">Blacklist (Always Block)</h3>
        <form id="blacklist-form" class="add-form">
          <input type="tel" name="phone_number" placeholder="+1-555-0200" required>
          <input type="text" name="label" placeholder="Name / label">
          <button type="submit">Add</button>
        </form>
        <div id="blacklist-entries" class="list-entries"></div>
      </div>
    </div>
  </section>

  <!-- Call Log Tab -->
  <section id="tab-call-log" class="tab-content">
    <div class="log-controls">
      <select id="log-filter">
        <option value="">All Classifications</option>
        <option value="blacklisted">Blacklisted</option>
        <option value="whitelisted">Whitelisted</option>
        <option value="spam_detected">Spam Detected</option>
        <option value="legitimate">Legitimate</option>
        <option value="unknown">Unknown</option>
      </select>
    </div>
    <table class="call-log-table">
      <thead>
        <tr>
          <th>Time</th>
          <th>From</th>
          <th>To Store</th>
          <th>Duration</th>
          <th>Classification</th>
          <th>Action</th>
          <th>Reason</th>
          <th>Flag</th>
        </tr>
      </thead>
      <tbody id="call-log-body"></tbody>
    </table>
    <div class="pagination">
      <button id="log-prev" disabled>Previous</button>
      <span id="log-page-info"></span>
      <button id="log-next">Next</button>
    </div>
  </section>

  <!-- Simulation Tab -->
  <section id="tab-simulation" class="tab-content">
    <div class="sim-controls">
      <div class="sim-status">
        Status: <span id="sim-status-text" class="status-stopped">Stopped</span>
      </div>
      <div class="sim-buttons">
        <button id="sim-start" class="btn-start">Start Simulation</button>
        <button id="sim-stop" class="btn-stop" disabled>Stop Simulation</button>
      </div>
    </div>
    <h3>Demo Profiles</h3>
    <p class="sim-description">Trigger individual calls from each persona to see how the filter handles them.</p>
    <div id="sim-profiles" class="profiles-grid"></div>
  </section>

  <!-- Nucleus Voice Tab -->
  <section id="tab-nucleus-voice" class="tab-content">
    <div class="nucleus-status-bar">
      <div class="nucleus-status-info">
        <span>API Key: <span id="nv-api-status" class="status-stopped">Not configured</span></span>
        <span>Webhook URL: <span id="nv-webhook-url">—</span></span>
      </div>
    </div>

    <div class="nucleus-setup-section">
      <h3>Setup</h3>
      <p class="sim-description">Create the Nucleus voice agents and provision phone numbers for each store location. This only needs to be done once.</p>
      <div class="nucleus-setup-buttons">
        <button id="nv-setup" class="btn-start">Run Setup</button>
        <button id="nv-teardown" class="btn-stop">Teardown All</button>
      </div>
    </div>

    <div class="nucleus-agents-section">
      <h3>Voice Agents</h3>
      <div id="nv-agents" class="profiles-grid"></div>
    </div>

    <div class="nucleus-numbers-section">
      <h3>Store Phone Numbers</h3>
      <p class="sim-description">Call these numbers to test the filtering. Whitelisted callers get the store assistant, blacklisted callers hear a blocked message, and unknown callers are screened.</p>
      <div id="nv-numbers" class="profiles-grid"></div>
    </div>
  </section>

  <script src="/js/api.js"></script>
  <script src="/js/dashboard.js"></script>
  <script src="/js/phone-lists.js"></script>
  <script src="/js/call-log.js"></script>
  <script src="/js/simulation.js"></script>
  <script src="/js/nucleus-voice.js"></script>
  <script src="/js/app.js"></script>
</body>
</html>
